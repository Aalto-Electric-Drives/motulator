
<!DOCTYPE html>


<html lang="en" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Observers &#8212; motulator 0.7.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=8f2a1f02" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css?v=d2d258e8" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css?v=f4aeca0c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css?v=2082cf3c" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css?v=1277b6f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=ebd526be" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=7dd04bbd"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>window.MathJax = {"loader": {"load": ["[tex]/upgreek"]}, "tex": {"packages": {"[+]": ["upgreek"]}, "macros": {"jj": "\\mathrm{j}", "e": "\\mathrm{e}", "D": "\\mathrm{d}", "IM": "\\mathrm{Im}", "RE": "\\mathrm{Re}", "T": "\\intercal", "uc": "\\mathbf{u}_\\mathrm{c}", "ucref": "\\mathbf{u}_\\mathrm{c}^\\mathrm{ref}", "ucreflim": "\\bar{\\mathbf{u}}_\\mathrm{c}^\\mathrm{ref}", "ucs": "\\mathbf{u}_\\mathrm{c}^\\mathrm{s}", "ic": "\\mathbf{i}_\\mathrm{c}", "icref": "\\mathbf{i}_\\mathrm{c}^\\mathrm{ref}", "ics": "\\mathbf{i}_\\mathrm{c}^\\mathrm{s}", "qc": "\\mathbf{q}_\\mathrm{c}", "qcs": "\\mathbf{q}_\\mathrm{c}^\\mathrm{s}", "dc": "\\mathbf{d}_\\mathrm{c}", "dcs": "\\mathbf{d}_\\mathrm{c}^\\mathrm{s}", "us": "\\mathbf{u}_\\mathrm{s}", "uss": "\\mathbf{u}_\\mathrm{s}^\\mathrm{s}", "usref": "\\mathbf{u}_\\mathrm{s}^\\mathrm{ref}", "usreflim": "\\bar{\\mathbf{u}}_\\mathrm{s}^\\mathrm{ref}", "is": "\\mathbf{i}_\\mathrm{s}", "isref": "\\mathbf{i}_\\mathrm{s}^\\mathrm{ref}", "iss": "\\mathbf{i}_\\mathrm{s}^\\mathrm{s}", "ir": "\\mathbf{i}_\\mathrm{r}", "irs": "\\mathbf{i}_\\mathrm{r}^\\mathrm{s}", "iR": "\\mathbf{i}_\\mathrm{R}", "psis": "\\boldsymbol{\\uppsi}_\\mathrm{s}", "psisref": "\\boldsymbol{\\uppsi}_\\mathrm{s}^\\mathrm{ref}", "hatpsis": "\\hat{\\boldsymbol{\\uppsi}}_\\mathrm{s}", "psiss": "\\boldsymbol{\\uppsi}_\\mathrm{s}^\\mathrm{s}", "tildepsis": "\\tilde{\\boldsymbol{\\uppsi}}_\\mathrm{s}", "tildepsiR": "\\tilde{\\boldsymbol{\\uppsi}}_\\mathrm{R}", "psir": "\\boldsymbol{\\uppsi}_\\mathrm{r}", "psirs": "\\boldsymbol{\\uppsi}_\\mathrm{r}^\\mathrm{s}", "psiR": "\\boldsymbol{\\uppsi}_\\mathrm{R}", "psiRo": "\\boldsymbol{\\uppsi}_\\mathrm{R0}", "hatpsiR": "\\hat{\\boldsymbol{\\uppsi}}_\\mathrm{R}", "psiaux": "\\boldsymbol{\\uppsi}_\\mathrm{a}", "hatpsiaux": "\\hat{\\boldsymbol{\\uppsi}}_\\mathrm{a}", "iaux": "\\mathbf{i}_\\mathrm{a}", "hatiaux": "\\hat{\\mathbf{i}}_\\mathrm{a}", "es": "\\mathbf{e}_\\mathrm{s}", "ec": "\\mathbf{e}_\\mathrm{c}", "eo": "\\mathbf{e}_\\mathrm{o}", "isfcn": "\\mathbf{g}", "idfcn": "g_\\mathrm{d}", "iqfcn": "g_\\mathrm{q}", "psisfcn": "\\mathbf{f}", "hatpsisfcn": "\\hat{\\mathbf{f}}", "psidfcn": "f_\\mathrm{d}", "psiqfcn": "f_\\mathrm{q}", "abspsis": "\\psi_\\mathrm{s}", "abspsisref": "\\psi_\\mathrm{s}^\\mathrm{ref}", "hatabspsis": "\\hat{\\psi}_\\mathrm{s}", "hatabspsiR": "\\hat{\\psi}_\\mathrm{R}", "psif": "\\psi_\\mathrm{f}", "absis": "i_\\mathrm{s}", "psid": "\\psi_\\mathrm{d}", "psiq": "\\psi_\\mathrm{q}", "id": "i_\\mathrm{d}", "iq": "i_\\mathrm{q}", "tildepsisd": "\\tilde{\\psi}_\\mathrm{sd}", "tildepsisq": "\\tilde{\\psi}_\\mathrm{sq}", "Rs": "R_\\mathrm{s}", "Rr": "R_\\mathrm{r}", "Ls": "L_\\mathrm{s}", "Lsgm": "L_\\upsigma", "Rsgm": "R_\\upsigma", "LM": "L_\\mathrm{M}", "RR": "R_\\mathrm{R}", "Ld": "L_\\mathrm{d}", "Lq": "L_\\mathrm{q}", "Ldd": "L_\\mathrm{dd}", "Lqq": "L_\\mathrm{qq}", "Ldq": "L_\\mathrm{dq}", "Gdd": "\\varGamma_\\mathrm{dd}", "Gqq": "\\varGamma_\\mathrm{qq}", "Gdq": "\\varGamma_\\mathrm{dq}", "omegam": "\\omega_\\mathrm{m}", "omegamo": "\\omega_\\mathrm{m0}", "tildeomegam": "\\tilde{\\omega}_\\mathrm{m}", "omegaM": "\\omega_\\mathrm{M}", "omegaMref": "\\omega_\\mathrm{M}^\\mathrm{ref}", "omegamref": "\\omega_\\mathrm{m}^\\mathrm{ref}", "omegaL": "\\omega_\\mathrm{L}", "omegas": "\\omega_\\mathrm{s}", "hatomegas": "\\hat{\\omega}_\\mathrm{s}", "hatomegar": "\\hat{\\omega}_\\mathrm{r}", "omegaso": "\\omega_\\mathrm{s0}", "omegar": "\\omega_\\mathrm{r}", "omegarb": "\\omega_\\mathrm{rb}", "omegaro": "\\omega_\\mathrm{r0}", "thetam": "\\vartheta_\\mathrm{m}", "thetaM": "\\vartheta_\\mathrm{M}", "thetaL": "\\vartheta_\\mathrm{L}", "thetaML": "\\vartheta_\\mathrm{ML}", "tauM": "\\tau_\\mathrm{M}", "hattauM": "\\hat{\\tau}_\\mathrm{M}", "hattauL": "\\hat{\\tau}_\\mathrm{L}", "tauMref": "\\tau_\\mathrm{M}^\\mathrm{ref}", "tauL": "\\tau_\\mathrm{L}", "tauLtot": "\\tau_\\mathrm{L,tot}", "tauS": "\\tau_\\mathrm{S}", "np": "n_\\mathrm{p}", "JM": "J_\\mathrm{M}", "JL": "J_\\mathrm{L}", "BL": "B_\\mathrm{L}", "CS": "C_\\mathrm{S}", "KS": "K_\\mathrm{S}", "Ts": "T_\\mathrm{s}", "Tsw": "T_\\mathrm{sw}", "ismax": "i_\\mathrm{s}^\\mathrm{max}", "dA": "d_\\mathrm{a}", "dB": "d_\\mathrm{b}", "dC": "d_\\mathrm{c}", "qA": "q_\\mathrm{a}", "qB": "q_\\mathrm{b}", "qC": "q_\\mathrm{c}", "udc": "u_\\mathrm{dc}", "udcref": "u_\\mathrm{dc}^\\mathrm{ref}", "idc": "i_\\mathrm{dc}", "udi": "u_\\mathrm{di}", "iL": "i_\\mathrm{L}", "Cdc": "C_\\mathrm{dc}", "hatCdc": "\\hat{C}_\\mathrm{dc}", "Ldc": "L_\\mathrm{dc}", "iA": "i_\\mathrm{a}", "iB": "i_\\mathrm{b}", "iC": "i_\\mathrm{c}", "uAn": "u_\\mathrm{an}", "uBn": "u_\\mathrm{bn}", "uCn": "u_\\mathrm{cn}", "uAN": "u_\\mathrm{aN}", "uBN": "u_\\mathrm{bN}", "uCN": "u_\\mathrm{cN}", "Cf": "C_\\mathrm{f}", "Lf": "L_\\mathrm{f}", "Rf": "R_\\mathrm{f}", "Lg": "L_\\mathrm{g}", "Rg": "R_\\mathrm{g}", "Lt": "L_\\mathrm{t}", "Rt": "R_\\mathrm{t}", "Lfc": "L_\\mathrm{fc}", "Rfc": "R_\\mathrm{fc}", "Lfg": "L_\\mathrm{fg}", "Rfg": "R_\\mathrm{fg}", "ug": "\\mathbf{u}_\\mathrm{g}", "ugo": "\\mathbf{u}_\\mathrm{g0}", "tildeug": "\\tilde{\\mathbf{u}}_\\mathrm{g}", "absug": "u_\\mathrm{g}", "hatabsug": "\\hat{u}_\\mathrm{g}", "hatug": "\\hat{\\mathbf{u}}_\\mathrm{g}", "ugs": "\\mathbf{u}_\\mathrm{g}^\\mathrm{s}", "ig": "\\mathbf{i}_\\mathrm{g}", "igs": "\\mathbf{i}_\\mathrm{g}^\\mathrm{s}", "eg": "\\mathbf{e}_\\mathrm{g}", "egs": "\\mathbf{e}_\\mathrm{g}^\\mathrm{s}", "uf": "\\mathbf{u}_\\mathrm{f}", "ufs": "\\mathbf{u}_\\mathrm{f}^\\mathrm{s}", "vc": "\\mathbf{v}_\\mathrm{c}", "hatvc": "\\hat{\\mathbf{v}}_\\mathrm{c}", "omegag": "\\omega_\\mathrm{g}", "hatomegag": "\\hat{\\omega}_\\mathrm{g}", "thetac": "\\vartheta_\\mathrm{c}", "thetag": "\\vartheta_\\mathrm{g}", "hatthetag": "\\hat{\\vartheta}_\\mathrm{g}", "omegac": "\\omega_\\mathrm{c}", "Wdc": "W_\\mathrm{dc}", "hatWdc": "\\hat{W}_\\mathrm{dc}", "Wdcref": "W_\\mathrm{dc}^\\mathrm{ref}", "pg": "p_\\mathrm{g}", "hatpg": "\\hat{p}_\\mathrm{g}", "pgref": "p_\\mathrm{g}^\\mathrm{ref}", "vcref": "v_\\mathrm{c}^\\mathrm{ref}", "hatabsvc": "\\hat{v}_\\mathrm{c}", "kt": "k_\\mathrm{t}", "kp": "k_\\mathrm{p}", "ki": "k_\\mathrm{i}", "alphai": "\\alpha_\\mathrm{i}", "ui": "u_\\mathrm{i}", "uff": "u_\\mathrm{ff}", "kd": "k_\\mathrm{d}", "kq": "k_\\mathrm{q}", "kotheta": "k_{\\mathrm{o}\\upvartheta}", "koomega": "k_{\\mathrm{o}\\upomega}", "kotau": "k_{\\mathrm{o}\\uptau}", "kT": "\\mathbf{k}_\\mathrm{t}", "kP": "\\mathbf{k}_\\mathrm{p}", "kI": "\\mathbf{k}_\\mathrm{i}", "uI": "\\mathbf{u}_\\mathrm{i}", "uFF": "\\mathbf{u}_\\mathrm{ff}", "kV": "\\mathbf{k}_\\mathrm{v}", "koa": "\\mathbf{k}_\\mathrm{o1}", "kob": "\\mathbf{k}_\\mathrm{o2}", "alphac": "\\alpha_\\mathrm{c}", "alphas": "\\alpha_\\mathrm{s}", "alphao": "\\alpha_\\mathrm{o}", "alphadc": "\\alpha_\\mathrm{dc}", "alphapll": "\\alpha_\\mathrm{pll}", "hatomegam": "\\hat{\\omega}_\\mathrm{m}", "hatthetam": "\\hat{\\vartheta}_\\mathrm{m}", "tildethetam": "\\tilde{\\vartheta}_\\mathrm{m}", "hatRs": "\\hat{R}_\\mathrm{s}", "hatRR": "\\hat{R}_\\mathrm{R}", "hatLs": "\\hat{L}_\\mathrm{s}", "hatLM": "\\hat{L}_\\mathrm{M}", "hatalpha": "\\hat{\\alpha}", "hatLsgm": "\\hat{L}_\\sigma", "hatRsgm": "\\hat{R}_\\sigma", "hatLd": "\\hat{L}_\\mathrm{d}", "hatLq": "\\hat{L}_\\mathrm{q}"}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'control/drive/observers';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Reference Generation" href="reference_gen.html" />
    <link rel="prev" title="Flux-Vector Control" href="flux_vector_ctrl.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">motulator 0.7.1 documentation</p>
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Getting Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../usage.html">Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributing.html">Contributing</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Examples</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../drive_examples/index.html">Drives</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../drive_examples/flux_vector/index.html">Flux-Vector Control</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/flux_vector/plot_2kw_ipmsm_fvc.html">2.2-kW IPMSM, FVC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/flux_vector/plot_2kw_im_sat_fvc.html">2.2-kW saturated IM, FVC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/flux_vector/plot_7kw_syrm_sat_fvc.html">6.7-kW saturated SyRM, FVC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/flux_vector/plot_5kw_pmsyrm_thor_sat_fvc.html">5.1-kW saturated PM-SyRM, FVC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/flux_vector/plot_6kw_pmsyrm_sat_fvc.html">5.6-kW saturated PM-SyRM, FVC</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../drive_examples/current_vector/index.html">Current-Vector Control</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/current_vector/plot_7kw_syrm_cvc.html">6.7-kW SyRM, CVC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/current_vector/plot_2kw_im_cvc_tq.html">2.2-kW IM, CVC, torque-control mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/current_vector/plot_2kw_ipmsm_diode_cvc.html">2.2-kW IPMSM, diode bridge, CVC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/current_vector/plot_2kw_ipmsm_cvc_adapt.html">2.2-kW IPMSM, CVC, PM-flux adaptation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/current_vector/plot_2kw_im_sat_cvc.html">2.2-kW saturated IM, CVC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/current_vector/plot_5kw_pmsyrm_thor_sat_cvc.html">5.1-kW saturated PM-SyRM, CVC</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../drive_examples/vhz/index.html">V/Hz Control</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/vhz/plot_2kw_im_ovhz.html">2.2-kW IM, O-V/Hz control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/vhz/plot_2kw_ipmsm_ovhz.html">2.2-kW IPMSM, O-V/Hz control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/vhz/plot_2kw_im_diode_vhz.html">2.2-kW IM, diode bridge, V/Hz control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/vhz/plot_7kw_syrm_sat_ovhz.html">6.7-kW saturated SyRM, O-V/Hz control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/vhz/plot_2kw_im_lc_vhz.html">2.2-kW IM, LC filter, V/Hz control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/vhz/plot_2kw_ipmsm_2mass_ovhz.html">2.2-kW IPMSM, 2-mass mechanics, O-V/Hz control</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../drive_examples/signal_inj/index.html">Signal Injection</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/signal_inj/plot_2kw_ipmsm_signal_inj.html">2.2-kW IPMSM, signal injection</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../drive_examples/signal_inj/plot_7kw_syrm_signal_inj.html">6.7-kW saturated SyRM, signal injection</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../grid_examples/index.html">Grid Converters</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../grid_examples/grid_following/index.html">Grid-Following Control</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../grid_examples/grid_following/plot_10kva_lcl_gfl.html">10-kVA, LCL filter, GFL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../grid_examples/grid_following/plot_10kva_dc_bus_gfl.html">10-kVA, DC bus, GFL</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../grid_examples/grid_following/plot_10kva_gfl.html">10-kVA, GFL</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../grid_examples/grid_forming/index.html">Grid-Forming Control</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../grid_examples/grid_forming/plot_13kva_rfpsc_gfm.html">12.5-kVA, RFPSC-GFM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../grid_examples/grid_forming/plot_13kva_do_gfm.html">12.5-kVA, DO-GFM</a></li>
</ul>
</details></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">System Models</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../model/common/index.html">Common</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../model/common/sampled_data.html">Sampled-Data Systems</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model/common/space_vectors.html">Space Vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model/common/converters.html">Voltage-Source Converter</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../model/drive/index.html">Drives</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../model/drive/induction_machine.html">Induction Machines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model/drive/synchronous_machine.html">Synchronous Machines</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model/drive/mechanics.html">Mechanics</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model/drive/ac_filter.html">Output LC Filter</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model/drive/diode_bridge.html">Six-Pulse Diode Bridge</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../model/grid/index.html">Grid Converters</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../../model/grid/filter_and_grid.html">AC Filter and Grid Impedance</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../model/grid/grid_volt_source.html">Three-Phase Source</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Control Methods</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../common/index.html">Common</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../common/control_system.html">Control System Framework</a></li>
<li class="toctree-l2"><a class="reference internal" href="../common/controllers.html">Controllers</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="index.html">Drives</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="speed_ctrl.html">Speed Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="current_ctrl.html">Current Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="flux_vector_ctrl.html">Flux-Vector Control</a></li>
<li class="toctree-l2 current active"><a class="current reference internal" href="#">Observers</a></li>
<li class="toctree-l2"><a class="reference internal" href="reference_gen.html">Reference Generation</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../grid/index.html">Grid Converters</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../grid/dc_voltage_ctrl.html">DC-Bus Voltage Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../grid/current_ctrl.html">Current Control</a></li>
<li class="toctree-l2"><a class="reference internal" href="../grid/pll.html">Phase-Locked Loop</a></li>
<li class="toctree-l2"><a class="reference internal" href="../grid/grid-forming.html">Grid-Forming Control</a></li>
</ul>
</details></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Reference</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../autoapi/motulator/index.html">API</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../autoapi/motulator/common/index.html">motulator.common</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/motulator/common/control/index.html">motulator.common.control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/motulator/common/model/index.html">motulator.common.model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/motulator/common/utils/index.html">motulator.common.utils</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../autoapi/motulator/drive/index.html">motulator.drive</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../autoapi/motulator/drive/control/index.html">motulator.drive.control</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/motulator/drive/control/im/index.html">motulator.drive.control.im</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/motulator/drive/control/sm/index.html">motulator.drive.control.sm</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/motulator/drive/model/index.html">motulator.drive.model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/motulator/drive/utils/index.html">motulator.drive.utils</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../autoapi/motulator/grid/index.html">motulator.grid</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/motulator/grid/control/index.html">motulator.grid.control</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/motulator/grid/model/index.html">motulator.grid.model</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/motulator/grid/utils/index.html">motulator.grid.utils</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../bibliography.html">Bibliography</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/Aalto-Electric-Drives/motulator" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/control/drive/observers.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Observers</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#for-induction-machines">For Induction Machines</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#machine-model">Machine Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flux-observer">Flux Observer</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#gain-analysis-and-selection">Gain Analysis and Selection</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sensored-drives">Sensored Drives</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sensorless-drives">Sensorless Drives</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#speed-observer">Speed Observer</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Gain Analysis and Selection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#for-synchronous-machines">For Synchronous Machines</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Machine Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinate-transformation">Coordinate Transformation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flux-and-position-observer">Flux and Position Observer</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Gain Analysis and Selection</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Sensored Drives</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sm-obs-sensorless">Sensorless Drives</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Speed Observer</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">Gain Analysis and Selection</a></li>
</ul>
</li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="observers">
<h1>Observers<a class="headerlink" href="#observers" title="Link to this heading">#</a></h1>
<p>Observers estimate the internal state of electrical machines. In this document, we describe the observer design for induction and synchronous machines, including both sensored and sensorless designs. The observer designs allow to take the magnetic saturation into account.</p>
<section id="for-induction-machines">
<h2>For Induction Machines<a class="headerlink" href="#for-induction-machines" title="Link to this heading">#</a></h2>
<p>In induction machine drives, the flux linkages and torque are estimated. In sensorless drives, the rotor speed is also estimated. Sensored and sensorless reduced-order observer designs <span id="id1">[<a class="reference internal" href="../../bibliography.html#id13" title="Harnefors. Design and analysis of general rotor-flux-oriented vector control systems. IEEE Trans. Ind. Electron., 2001. doi:10.1109/41.915417.">Harnefors, 2001</a>, <a class="reference internal" href="../../bibliography.html#id19" title="Hinkkanen, Harnefors, and Luomi. Reduced-order flux observers with stator-resistance adaptation for speed-sensorless induction motor drives. IEEE Trans. Power Electron., 2010. doi:10.1109/TPEL.2009.2039650.">Hinkkanen <em>et al.</em>, 2010</a>, <a class="reference internal" href="../../bibliography.html#id48" title="Verghese and Sanders. Observers for flux estimation in induction machines. IEEE Trans. Ind. Electron., 1988. doi:10.1109/41.3067.">Verghese and Sanders, 1988</a>]</span> are available in the <a class="reference internal" href="../../autoapi/motulator/drive/control/im/index.html#motulator.drive.control.im.FluxObserver" title="motulator.drive.control.im.FluxObserver"><code class="xref py py-class docutils literal notranslate"><span class="pre">motulator.drive.control.im.FluxObserver</span></code></a> and <a class="reference internal" href="../../autoapi/motulator/drive/control/im/index.html#motulator.drive.control.im.SpeedFluxObserver" title="motulator.drive.control.im.SpeedFluxObserver"><code class="xref py py-class docutils literal notranslate"><span class="pre">motulator.drive.control.im.SpeedFluxObserver</span></code></a> classes.</p>
<section id="machine-model">
<h3>Machine Model<a class="headerlink" href="#machine-model" title="Link to this heading">#</a></h3>
<p>The inverse-Î“ model of an induction machine is considered (see <a class="reference internal" href="../../model/drive/induction_machine.html#equation-im-inv-gamma-ss">(6)</a> in <a class="reference internal" href="../../model/drive/induction_machine.html"><span class="doc">Induction Machines</span></a>). In a coordinate system rotating at the angular speed <span class="math notranslate nohighlight">\(\omegac\)</span>, the dynamics can be expressed as</p>
<div class="math notranslate nohighlight" id="equation-im-model-obs">
<span class="eqno">(1)<a class="headerlink" href="#equation-im-model-obs" title="Link to this equation">#</a></span>\[\begin{split}    \frac{\D \psis}{\D t} &amp;= \us - \Rs\is - \jj\omegac\psis \\
    \Lsgm\frac{\D \is}{\D t} &amp;= \us - (\Rsgm + \jj\omegac \Lsgm)\is
    + \left(\alpha - \jj\omegam\right)\psiR \\
    \psiR &amp;= \psis - \Lsgm\is \\
    \tauM &amp;= \frac{3\np}{2}\IM\left\{\is \psis^* \right\}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\alpha = \RR/\LM\)</span> and <span class="math notranslate nohighlight">\(\Rsgm = \Rs + \RR\)</span>.</p>
</section>
<section id="flux-observer">
<h3>Flux Observer<a class="headerlink" href="#flux-observer" title="Link to this heading">#</a></h3>
<p>A reduced-order observer is implemented in the <a class="reference internal" href="../../autoapi/motulator/drive/control/im/index.html#motulator.drive.control.im.FluxObserver" title="motulator.drive.control.im.FluxObserver"><code class="xref py py-class docutils literal notranslate"><span class="pre">motulator.drive.control.im.FluxObserver</span></code></a> class. Based on <a class="reference internal" href="#equation-im-model-obs">(1)</a>, the observer is formulated as</p>
<div class="math notranslate nohighlight" id="equation-im-obs">
<span class="eqno">(2)<a class="headerlink" href="#equation-im-obs" title="Link to this equation">#</a></span>\[\begin{split}    \frac{\D \hatpsis}{\D t} &amp;= \us - \hatRs\is - \jj\omegac\hatpsis + \koa\eo + \kob\eo^* \\
    \hatpsiR &amp;= \hatpsis - \hatLsgm\is\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\us\)</span> is the realized voltage estimate obtained from the PWM algorithm, <span class="math notranslate nohighlight">\(\koa\)</span> and <span class="math notranslate nohighlight">\(\kob\)</span> are complex gains, the estimates are marked with the hat, and <span class="math notranslate nohighlight">\(^*\)</span> marks the complex conjugate. The estimation error is</p>
<div class="math notranslate nohighlight" id="equation-im-eo">
<span class="eqno">(3)<a class="headerlink" href="#equation-im-eo" title="Link to this equation">#</a></span>\[    \eo = \hatLsgm\frac{\D \is}{\D t} - \us + \left(\hatRsgm + \jj\omegac\hatLsgm\right)\is - \left(\hatalpha - \jj\hatomegam\right)\hatpsiR\]</div>
<p>where <span class="math notranslate nohighlight">\(\hatomegam\)</span> is the rotor speed estimate. In sensored drives, the speed estimate is replaced with the measured speed, <span class="math notranslate nohighlight">\(\hatomegam = \omegam\)</span>. In observer-based V/Hz control <span id="id2">[<a class="reference internal" href="../../bibliography.html#id45" title="Tiitinen, Hinkkanen, and Harnefors. Sensorless flux-vector control framework: an extension for induction machines. IEEE Trans. Ind. Electron., 2025. doi:10.1109/TIE.2025.3559958.">Tiitinen <em>et al.</em>, 2025</a>]</span>, the speed estimate is replaced with the (rate-limited) speed reference, <span class="math notranslate nohighlight">\(\hatomegam = \omegamref\)</span>. Note that the derivative of the stator current in <a class="reference internal" href="#equation-im-eo">(3)</a> is integrated, i.e., the noise is not amplified. The torque estimate is given by</p>
<div class="math notranslate nohighlight" id="equation-im-obs-taum">
<span class="eqno">(4)<a class="headerlink" href="#equation-im-obs-taum" title="Link to this equation">#</a></span>\[    \hattauM = \frac{3\np}{2}\IM\left\{\is \hatpsis^* \right\}\]</div>
<p>The magnetic saturation <span class="math notranslate nohighlight">\(\hatLs = \hatLs(\hatabspsis)\)</span> can be taken into account using the <a class="reference internal" href="../../autoapi/motulator/drive/model/index.html#motulator.drive.model.InductionMachinePars" title="motulator.drive.model.InductionMachinePars"><code class="xref py py-class docutils literal notranslate"><span class="pre">motulator.drive.model.InductionMachinePars</span></code></a> class.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The angular speed <span class="math notranslate nohighlight">\(\omegac\)</span> of the controller coordinate system can be arbitrarily selected. In the <a class="reference internal" href="../../autoapi/motulator/drive/control/im/index.html#motulator.drive.control.im.FluxObserver" title="motulator.drive.control.im.FluxObserver"><code class="xref py py-class docutils literal notranslate"><span class="pre">motulator.drive.control.im.FluxObserver</span></code></a> class, it is set to <span class="math notranslate nohighlight">\(\omegac = \hatomegam + \hatomegar\)</span>, which allows simple discretization since the DC quantities are estimated in the steady state. Estimated rotor coordinates <span class="math notranslate nohighlight">\(\omegac = \hatomegam\)</span> could also be used, while using <span class="math notranslate nohighlight">\(\omegac = 0\)</span> would require a more complex discretization.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Real-valued column vectors and the corresponding <span class="math notranslate nohighlight">\(2\times 2\)</span> gain matrix were used in <span id="id3">[<a class="reference internal" href="../../bibliography.html#id19" title="Hinkkanen, Harnefors, and Luomi. Reduced-order flux observers with stator-resistance adaptation for speed-sensorless induction motor drives. IEEE Trans. Power Electron., 2010. doi:10.1109/TPEL.2009.2039650.">Hinkkanen <em>et al.</em>, 2010</a>]</span>. The complex form in <a class="reference internal" href="#equation-im-obs">(2)</a> has the same degrees of freedom.</p>
</div>
<section id="gain-analysis-and-selection">
<h4>Gain Analysis and Selection<a class="headerlink" href="#gain-analysis-and-selection" title="Link to this heading">#</a></h4>
<p>The estimation-error dynamics are obtained by subtracting <a class="reference internal" href="#equation-im-obs">(2)</a> from <a class="reference internal" href="#equation-im-model-obs">(1)</a>. The resulting system is linearized for analysis and gain selection purposes. Assuming accurate parameter estimates, linearized estimation-error dynamics are <span id="id4">[<a class="reference internal" href="../../bibliography.html#id19" title="Hinkkanen, Harnefors, and Luomi. Reduced-order flux observers with stator-resistance adaptation for speed-sensorless induction motor drives. IEEE Trans. Power Electron., 2010. doi:10.1109/TPEL.2009.2039650.">Hinkkanen <em>et al.</em>, 2010</a>]</span></p>
<div class="math notranslate nohighlight" id="equation-tilde-psis">
<span class="eqno">(5)<a class="headerlink" href="#equation-tilde-psis" title="Link to this equation">#</a></span>\[    \frac{\D \Delta\tildepsis}{\D t} = -\koa \Delta \eo - \kob \Delta \eo^* - \jj\omegaso \Delta\tildepsis\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta\)</span> marks the small-signal quantities, the subscript 0 marks the operating-point quantities, <span class="math notranslate nohighlight">\(\tildepsis = \psis - \hatpsis\)</span> is the estimation error, and <span class="math notranslate nohighlight">\(\omegaso\)</span> is the stator angular frequency. The linearized estimation error is</p>
<div class="math notranslate nohighlight" id="equation-eo-lin">
<span class="eqno">(6)<a class="headerlink" href="#equation-eo-lin" title="Link to this equation">#</a></span>\[    \Delta\eo = \left(\alpha - \jj\omegamo \right)\Delta\tildepsis - \jj\psiRo\Delta\tildeomegam\]</div>
<p>Notice that the rotor flux estimation error is <span class="math notranslate nohighlight">\(\Delta\tildepsiR = \Delta\tildepsis\)</span>.</p>
<section id="sensored-drives">
<h5>Sensored Drives<a class="headerlink" href="#sensored-drives" title="Link to this heading">#</a></h5>
<p>In sensored drives, <span class="math notranslate nohighlight">\(\Delta\tildeomegam = 0\)</span> holds and <span class="math notranslate nohighlight">\(\kob = 0\)</span> is used. Under these assumptions, the estimation-error dynamics <a class="reference internal" href="#equation-tilde-psis">(5)</a> reduce to <span id="id5">[<a class="reference internal" href="../../bibliography.html#id48" title="Verghese and Sanders. Observers for flux estimation in induction machines. IEEE Trans. Ind. Electron., 1988. doi:10.1109/41.3067.">Verghese and Sanders, 1988</a>]</span></p>
<div class="math notranslate nohighlight" id="equation-im-tilde-psis-sensored">
<span class="eqno">(7)<a class="headerlink" href="#equation-im-tilde-psis-sensored" title="Link to this equation">#</a></span>\[    \frac{\D \Delta\tildepsis}{\D t} = -\left[\koa \left(\alpha - \jj\omegamo \right) + \jj\omegaso \right]\Delta\tildepsis\]</div>
<p>The closed-loop pole can be arbitrarily placed via the gain <span class="math notranslate nohighlight">\(\koa\)</span>. The default gains for sensored drives are</p>
<div class="math notranslate nohighlight" id="equation-k1-sensored">
<span class="eqno">(8)<a class="headerlink" href="#equation-k1-sensored" title="Link to this equation">#</a></span>\[    \koa = 1 + \frac{g |\omegam|}{\hatalpha - \jj\omegam} \qquad
    \kob = 0\]</div>
<p>where <span class="math notranslate nohighlight">\(g\)</span> is a unitless positive design parameter. The corresponding pole is located at <span class="math notranslate nohighlight">\(s = -\alpha - g |\omegamo| - \jj\omegaro\)</span>, where <span class="math notranslate nohighlight">\(\omegaro = \omegaso - \omegamo\)</span> is the slip angular frequency.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>As a special case, <span class="math notranslate nohighlight">\(\koa = 0\)</span> yields the voltage model. As another special case, the current model is obtained choosing <span class="math notranslate nohighlight">\(\koa = 1\)</span>.</p>
</div>
</section>
<section id="sensorless-drives">
<span id="im-obs-sensorless"></span><h5>Sensorless Drives<a class="headerlink" href="#sensorless-drives" title="Link to this heading">#</a></h5>
<p>In sensorless drives, the rotor speed estimate <span class="math notranslate nohighlight">\(\hatomegam\)</span> is canceled out from the observer equations by choosing <span id="id6">[<a class="reference internal" href="../../bibliography.html#id19" title="Hinkkanen, Harnefors, and Luomi. Reduced-order flux observers with stator-resistance adaptation for speed-sensorless induction motor drives. IEEE Trans. Power Electron., 2010. doi:10.1109/TPEL.2009.2039650.">Hinkkanen <em>et al.</em>, 2010</a>]</span></p>
<div class="math notranslate nohighlight" id="equation-inherently">
<span class="eqno">(9)<a class="headerlink" href="#equation-inherently" title="Link to this equation">#</a></span>\[    \kob = \frac{\hatpsiR}{\hatpsiR^*} \koa\]</div>
<p>With this choice, the linearized estimation-error dynamics in <a class="reference internal" href="#equation-tilde-psis">(5)</a> become</p>
<div class="math notranslate nohighlight" id="equation-tilde-psis-sensorless">
<span class="eqno">(10)<a class="headerlink" href="#equation-tilde-psis-sensorless" title="Link to this equation">#</a></span>\[\begin{split}    \frac{\D}{\D t} \begin{bmatrix} \Delta\tildepsisd \\ \Delta\tildepsisq \end{bmatrix} = \begin{bmatrix} -2\kd\alpha &amp; -2\kd\omegamo + \omegaso \\ -2\kq\alpha - \omegaso &amp; -2\kq\omegamo
    \end{bmatrix}
    \begin{bmatrix} \Delta\tildepsisd \\ \Delta\tildepsisq \end{bmatrix}\end{split}\]</div>
<p>where the gain components correspond to <span class="math notranslate nohighlight">\(\koa = \kd + \jj \kq\)</span>. The attenuation <span class="math notranslate nohighlight">\(\sigma\)</span> can be assigned by choosing</p>
<div class="math notranslate nohighlight" id="equation-k1-sensorless">
<span class="eqno">(11)<a class="headerlink" href="#equation-k1-sensorless" title="Link to this equation">#</a></span>\[    \koa = \frac{\sigma}{\hat \alpha - \jj\hatomegam}\]</div>
<p>results in the characteristic polynomial <span class="math notranslate nohighlight">\(D(s) = s^2 + 2\sigma s + \omegaso^2\)</span>. In the default tuning, the attenuation is scheduled as <span class="math notranslate nohighlight">\(\sigma = \hat \alpha/2 + \zeta_\infty|\hatomegam|\)</span>, where <span class="math notranslate nohighlight">\(\zeta_\infty\)</span> is the desired damping ratio at high speeds. At zero stator frequency <span class="math notranslate nohighlight">\(\omegaso = 0\)</span>, the poles are located at <span class="math notranslate nohighlight">\(s = 0\)</span> and <span class="math notranslate nohighlight">\(s = -\alpha\)</span>, which allows stable magnetizing and starting the machine. <a class="reference internal" href="#fig-poles"><span class="std std-ref">Figure 1</span></a> shows the corresponding pole placement example.</p>
<figure class="align-center" id="fig-poles">
<a class="only-light reference internal image-reference" href="../../_images/poles.svg"><img alt="Pole placement example in sensorless drives" class="only-light" src="../../_images/poles.svg" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Figure 1:</em> Example pole placement of the sensorless observer.</span><a class="headerlink" href="#fig-poles" title="Link to this image">#</a></p>
</figcaption>
</figure>
<figure class="align-center" id="id26">
<a class="invert-colors-dark only-dark reference internal image-reference" href="../../_images/poles.svg"><img alt="Pole placement example in sensorless drives" class="invert-colors-dark only-dark" src="../../_images/poles.svg" style="width: 100%;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Figure 1:</em> Example pole placement of the sensorless observer.</span><a class="headerlink" href="#id26" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
</section>
</section>
<section id="speed-observer">
<h3>Speed Observer<a class="headerlink" href="#speed-observer" title="Link to this heading">#</a></h3>
<p>The flux observer <a class="reference internal" href="#equation-im-obs">(2)</a> is extended with the speed observer in the <a class="reference internal" href="../../autoapi/motulator/drive/control/im/index.html#motulator.drive.control.im.SpeedFluxObserver" title="motulator.drive.control.im.SpeedFluxObserver"><code class="xref py py-class docutils literal notranslate"><span class="pre">motulator.drive.control.im.SpeedFluxObserver</span></code></a> class. The speed-estimation error signal <span class="math notranslate nohighlight">\(\varepsilon\)</span> is extracted as</p>
<div class="math notranslate nohighlight" id="equation-im-obs-eps">
<span class="eqno">(12)<a class="headerlink" href="#equation-im-obs-eps" title="Link to this equation">#</a></span>\[    \varepsilon = -\IM\left\{ \frac{\eo}{\hatpsiR} \right\}\]</div>
<p>Considering the rotor speed to be a quasi-constant disturbance, the speed can be estimated as <span id="id7">[<a class="reference internal" href="../../bibliography.html#id13" title="Harnefors. Design and analysis of general rotor-flux-oriented vector control systems. IEEE Trans. Ind. Electron., 2001. doi:10.1109/41.915417.">Harnefors, 2001</a>]</span></p>
<div class="math notranslate nohighlight" id="equation-im-speed-obs-ro">
<span class="eqno">(13)<a class="headerlink" href="#equation-im-speed-obs-ro" title="Link to this equation">#</a></span>\[    \frac{\D \hatomegam}{\D t} = \koomega \varepsilon\]</div>
<p>This estimator is essentially the same as the conventional slip-relation-based estimator with the first-order low-pass filter <span id="id8">[<a class="reference internal" href="../../bibliography.html#id19" title="Hinkkanen, Harnefors, and Luomi. Reduced-order flux observers with stator-resistance adaptation for speed-sensorless induction motor drives. IEEE Trans. Power Electron., 2010. doi:10.1109/TPEL.2009.2039650.">Hinkkanen <em>et al.</em>, 2010</a>]</span>.</p>
<p>To avoid the lag in the speed estimate, the speed can be estimated based on the mechanical model and considering the load torque as a quasi-constant disturbance (see <a class="reference internal" href="../../model/drive/mechanics.html#equation-mech-stiff">(1)</a> in <a class="reference internal" href="../../model/drive/mechanics.html"><span class="doc">Mechanics</span></a>). This approach results in the speed observer</p>
<div class="math notranslate nohighlight" id="equation-im-speed-obs">
<span class="eqno">(14)<a class="headerlink" href="#equation-im-speed-obs" title="Link to this equation">#</a></span>\[\begin{split}    \frac{\D \hatomegam}{\D t} &amp;= \frac{\np}{\hat{J}}(\hattauM - \hattauL) + \koomega \varepsilon \\
    \frac{\D\hattauL}{\D t} &amp;= -\frac{\kotau}{\np} \varepsilon\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\hattauL\)</span> is the load torque estimate and <span class="math notranslate nohighlight">\(\koomega\)</span> and <span class="math notranslate nohighlight">\(\kotau\)</span> are the observer gains. This observer is analogous to the speed observer in <span id="id9">[<a class="reference internal" href="../../bibliography.html#id33" title="Lorenz and Van Patten. High-resolution velocity estimation for all-digital, ac servo drives. IEEE Trans. Ind. Appl., 1991. doi:10.1109/28.85485.">Lorenz and Van Patten, 1991</a>]</span>. Note that setting <span class="math notranslate nohighlight">\(\hat{J} = \infty\)</span> and <span class="math notranslate nohighlight">\(\kotau = 0\)</span> yields the estimator <a class="reference internal" href="#equation-im-speed-obs-ro">(13)</a>; clearly, the inertia estimate <span class="math notranslate nohighlight">\(\hat{J}\)</span> can be safely overestimated.</p>
<section id="id10">
<h4>Gain Analysis and Selection<a class="headerlink" href="#id10" title="Link to this heading">#</a></h4>
<p>The flux observer gain <a class="reference internal" href="#equation-inherently">(9)</a> decouples the rotor speed estimation from the flux estimation. Therefore, the speed estimation dynamics can be analyzed separately. The estimator <a class="reference internal" href="#equation-im-speed-obs-ro">(13)</a> results in the first-order estimation dynamics</p>
<div class="math notranslate nohighlight" id="equation-im-speed-obs-ro-lin">
<span class="eqno">(15)<a class="headerlink" href="#equation-im-speed-obs-ro-lin" title="Link to this equation">#</a></span>\[    \frac{\Delta\hatomegam(s)}{\Delta\omegam(s)} = \frac{\koomega}{s + \koomega}\]</div>
<p>The gain <span class="math notranslate nohighlight">\(\koomega = \alphao\)</span> determines the speed-estimation bandwidth.</p>
<p>For the observer <a class="reference internal" href="#equation-im-speed-obs">(14)</a>, the linearized estimation dynamics are</p>
<div class="math notranslate nohighlight" id="equation-im-speed-obs-lin">
<span class="eqno">(16)<a class="headerlink" href="#equation-im-speed-obs-lin" title="Link to this equation">#</a></span>\[    \frac{\Delta\hatomegam(s)}{\Delta\omegam(s)} = \frac{(J/\hat{J})s^2 + \koomega s + \kotau/\hat{J}}{s^2 + \koomega s + \kotau/\hat{J}}\]</div>
<p>where the stiff mechanical model is assumed in the derivation. The critically damped design is obtained by setting <span class="math notranslate nohighlight">\(\koomega = 2\alphao\)</span> and <span class="math notranslate nohighlight">\(\kotau = \alphao^2 \hat{J}\)</span>, where <span class="math notranslate nohighlight">\(\alphao\)</span> is the desired pole location.</p>
</section>
</section>
</section>
<section id="for-synchronous-machines">
<h2>For Synchronous Machines<a class="headerlink" href="#for-synchronous-machines" title="Link to this heading">#</a></h2>
<p>In synchronous machine drives, the flux linkage and the torque are estimated. In sensorless drives, the rotor speed and position are also estimated <span id="id11">[<a class="reference internal" href="../../bibliography.html#id10" title="Capecchi, Guglielmo, Pastorelli, and Vagati. Position-sensorless control of the transverse-laminated synchronous reluctance motor. IEEE Trans. Ind. Appl., 2001. doi:10.1109/28.968190.">Capecchi <em>et al.</em>, 2001</a>, <a class="reference internal" href="../../bibliography.html#id21" title="Hinkkanen, Saarakkala, Awan, MÃ¶lsÃ¤, and Tuovinen. Observers for sensorless synchronous motor drives: framework for design and analysis. IEEE Trans. Ind. Appl., 2018. doi:10.1109/TIA.2018.2858753.">Hinkkanen <em>et al.</em>, 2018</a>, <a class="reference internal" href="../../bibliography.html#id26" title="Jones and Lang. A state observer for the permanent-magnet synchronous motor. IEEE Trans. Ind. Electron., 1989. doi:10.1109/41.31500.">Jones and Lang, 1989</a>, <a class="reference internal" href="../../bibliography.html#id37" title="Piippo, Hinkkanen, and Luomi. Analysis of an adaptive observer for sensorless control of interior permanent magnet synchronous motors. IEEE Trans. Ind. Electron., 2008. doi:10.1109/TIE.2007.911949.">Piippo <em>et al.</em>, 2008</a>]</span>. This document describes an observer design implemented in the <a class="reference internal" href="../../autoapi/motulator/drive/control/sm/index.html#motulator.drive.control.sm.FluxObserver" title="motulator.drive.control.sm.FluxObserver"><code class="xref py py-class docutils literal notranslate"><span class="pre">motulator.drive.control.sm.FluxObserver</span></code></a> and <a class="reference internal" href="../../autoapi/motulator/drive/control/sm/index.html#motulator.drive.control.sm.SpeedFluxObserver" title="motulator.drive.control.sm.SpeedFluxObserver"><code class="xref py py-class docutils literal notranslate"><span class="pre">motulator.drive.control.sm.SpeedFluxObserver</span></code></a> classes, based on <span id="id12">[<a class="reference internal" href="../../bibliography.html#id21" title="Hinkkanen, Saarakkala, Awan, MÃ¶lsÃ¤, and Tuovinen. Observers for sensorless synchronous motor drives: framework for design and analysis. IEEE Trans. Ind. Appl., 2018. doi:10.1109/TIA.2018.2858753.">Hinkkanen <em>et al.</em>, 2018</a>]</span>. The observer supports both sensorless and sensored operating modes and accounts for magnetic saturation.</p>
<section id="id13">
<h3>Machine Model<a class="headerlink" href="#id13" title="Link to this heading">#</a></h3>
<p>The synchronous machine model in rotor coordinates rotating at <span class="math notranslate nohighlight">\(\omegam\)</span> is</p>
<div class="math notranslate nohighlight" id="equation-sm-model-obs">
<span class="eqno">(17)<a class="headerlink" href="#equation-sm-model-obs" title="Link to this equation">#</a></span>\[\begin{split}    \frac{\D\psis}{\D t} &amp;= \us - \Rs\is - \jj\omegam\psis \\
    \frac{\D\thetam}{\D t} &amp;= \omegam \\
    \is &amp;= \isfcn(\psis) \\
    \tauM &amp;= \frac{3 \np}{2}\IM\left\{\is\psis^*\right\}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\isfcn\)</span> is the current map (see <a class="reference internal" href="../../model/drive/synchronous_machine.html#synchronous-machine"><span class="std std-ref">Synchronous Machine Model</span></a>). If the magnetic saturation is omitted, the current is <span class="math notranslate nohighlight">\(\is = (\psid - \psif)/\Ld + \jj\psiq/\Lq\)</span>.</p>
</section>
<section id="coordinate-transformation">
<h3>Coordinate Transformation<a class="headerlink" href="#coordinate-transformation" title="Link to this heading">#</a></h3>
<p>The control system operates in estimated rotor coordinates, <span class="math notranslate nohighlight">\(\thetac = \hatthetam\)</span>, aligned at the rotor angle estimate. In these coordinates, the measured current and the realized voltage (obtained from the PWM algorithm), respectively, are</p>
<div class="math notranslate nohighlight" id="equation-is-prime">
<span class="eqno">(18)<a class="headerlink" href="#equation-is-prime" title="Link to this equation">#</a></span>\[    \is' = \iss \e^{-\jj\hatthetam} \qquad
    \us' = \us \e^{-\jj\hatthetam}\]</div>
<p>Due to the estimation error <span class="math notranslate nohighlight">\(\tildethetam = \thetam - \hatthetam\)</span>, the current <span class="math notranslate nohighlight">\(\is'\)</span> generally differs from the current <span class="math notranslate nohighlight">\(\is\)</span> (and similarly for the voltage).</p>
</section>
<section id="flux-and-position-observer">
<h3>Flux and Position Observer<a class="headerlink" href="#flux-and-position-observer" title="Link to this heading">#</a></h3>
<p>Based on <a class="reference internal" href="#equation-sm-model-obs">(17)</a>, a nonlinear state observer is formulated as</p>
<div class="math notranslate nohighlight" id="equation-sm-obs">
<span class="eqno">(19)<a class="headerlink" href="#equation-sm-obs" title="Link to this equation">#</a></span>\[\begin{split}    \frac{\D \hatpsis}{\D t} &amp;= \us' - \hatRs\is' - \jj\omegac\hatpsis + \koa \eo + \kob \eo^* \\
    \frac{\D\hatthetam}{\D t} &amp;= \hatomegam - \kotheta \IM\left\{ \frac{\eo}{\psiaux} \right\} = \omegac\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\omegac\)</span> is the angular speed of the coordinate system, <span class="math notranslate nohighlight">\(\eo\)</span> is the estimation error, <span class="math notranslate nohighlight">\(\koa\)</span>, <span class="math notranslate nohighlight">\(\kob\)</span>, and <span class="math notranslate nohighlight">\(\kotheta\)</span> are observer gains, the estimates are marked with the hat, and <span class="math notranslate nohighlight">\(^*\)</span> marks the complex conjugate. The flux estimation error is</p>
<div class="math notranslate nohighlight" id="equation-sm-eo">
<span class="eqno">(20)<a class="headerlink" href="#equation-sm-eo" title="Link to this equation">#</a></span>\[    \eo = \hatpsisfcn(\is') - \hatpsis\]</div>
<p>where <span class="math notranslate nohighlight">\(\hatpsisfcn\)</span> is the flux map estimate. This observer structure is used in the <a class="reference internal" href="../../autoapi/motulator/drive/control/sm/index.html#motulator.drive.control.sm.FluxObserver" title="motulator.drive.control.sm.FluxObserver"><code class="xref py py-class docutils literal notranslate"><span class="pre">motulator.drive.control.sm.FluxObserver</span></code></a> class. The implementation also contains optional PM-flux adaptation <span id="id14">[<a class="reference internal" href="../../bibliography.html#id46" title="Tuovinen, Awan, Kukkola, Saarakkala, and Hinkkanen. Permanent-magnet flux adaptation for sensorless synchronous motor drives. In Proc. IEEE SLED. 2018. doi:10.1109/SLED.2018.8485899.">Tuovinen <em>et al.</em>, 2018</a>]</span>, see the <a class="reference internal" href="../../drive_examples/current_vector/plot_2kw_ipmsm_cvc_adapt.html"><span class="doc">2.2-kW IPMSM, CVC, PM-flux adaptation</span></a> example.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Since the current is measured, the observer is fundamentally corrected by means of the current estimation error. However, due to the saliency and magnetic saturation, the current estimation error is convenient to map (or scale in the case of linear magnetics) to the flux linkage error.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Real-valued column vectors and the corresponding <span class="math notranslate nohighlight">\(2\times 2\)</span> gain matrix were used in <span id="id15">[<a class="reference internal" href="../../bibliography.html#id21" title="Hinkkanen, Saarakkala, Awan, MÃ¶lsÃ¤, and Tuovinen. Observers for sensorless synchronous motor drives: framework for design and analysis. IEEE Trans. Ind. Appl., 2018. doi:10.1109/TIA.2018.2858753.">Hinkkanen <em>et al.</em>, 2018</a>]</span>. The complex form in <a class="reference internal" href="#equation-sm-obs">(19)</a> has the same degrees of freedom.</p>
</div>
<section id="id16">
<h4>Gain Analysis and Selection<a class="headerlink" href="#id16" title="Link to this heading">#</a></h4>
<section id="id17">
<h5>Sensored Drives<a class="headerlink" href="#id17" title="Link to this heading">#</a></h5>
<p>In sensored case, <span class="math notranslate nohighlight">\(\tildethetam = 0\)</span> holds and <span class="math notranslate nohighlight">\(\kob = 0\)</span> is used. Therefore, using <a class="reference internal" href="#equation-sm-model-obs">(17)</a> and <a class="reference internal" href="#equation-sm-obs">(19)</a>, the linearized estimation-error dynamics become</p>
<div class="math notranslate nohighlight" id="equation-sm-tilde-psis-sensored">
<span class="eqno">(21)<a class="headerlink" href="#equation-sm-tilde-psis-sensored" title="Link to this equation">#</a></span>\[    \frac{\D \Delta\tildepsis}{\D t} = -(\koa + \jj\omegamo)\Delta\tildepsis\]</div>
<p>where <span class="math notranslate nohighlight">\(\Delta\)</span> marks the small-signal quantities, the subscript 0 marks the operating-point quantities, and <span class="math notranslate nohighlight">\(\tildepsis = \psis - \hatpsis\)</span> is the estimation error. The pole can be arbitrarily placed via the gain <span class="math notranslate nohighlight">\(\koa\)</span>. Well-damped dynamics are obtained simply with a real gain, <span class="math notranslate nohighlight">\(\koa = \sigma\)</span>, resulting in the pole at <span class="math notranslate nohighlight">\(s = -\sigma - \jj\omegamo\)</span>, where <span class="math notranslate nohighlight">\(\sigma = 2\pi \cdot 15\)</span> rad/s is used as the default value in the <a class="reference internal" href="../../autoapi/motulator/drive/control/sm/index.html#motulator.drive.control.sm.FluxObserver" title="motulator.drive.control.sm.FluxObserver"><code class="xref py py-class docutils literal notranslate"><span class="pre">motulator.drive.control.sm.FluxObserver</span></code></a> class in sensored drives.</p>
</section>
<section id="sm-obs-sensorless">
<span id="id18"></span><h5>Sensorless Drives<a class="headerlink" href="#sm-obs-sensorless" title="Link to this heading">#</a></h5>
<p>The analysis of the sensorless case resembles that of induction machines, see <a class="reference internal" href="#im-obs-sensorless"><span class="std std-ref">Sensorless Drives</span></a>. The following results can be derived from the linearized form of <a class="reference internal" href="#equation-sm-model-obs">(17)</a> â€“ <a class="reference internal" href="#equation-sm-obs">(19)</a>, see details in <span id="id19">[<a class="reference internal" href="../../bibliography.html#id21" title="Hinkkanen, Saarakkala, Awan, MÃ¶lsÃ¤, and Tuovinen. Observers for sensorless synchronous motor drives: framework for design and analysis. IEEE Trans. Ind. Appl., 2018. doi:10.1109/TIA.2018.2858753.">Hinkkanen <em>et al.</em>, 2018</a>]</span>.</p>
<p>To decouple the flux estimation from the rotor angle, the gains of <a class="reference internal" href="#equation-sm-obs">(19)</a> have to be of the form</p>
<div class="math notranslate nohighlight" id="equation-k1k2-sensorless">
<span class="eqno">(22)<a class="headerlink" href="#equation-k1k2-sensorless" title="Link to this equation">#</a></span>\[    \koa = \sigma \qquad
    \kob = \frac{\sigma\hatpsiaux}{\hatpsiaux^*}\]</div>
<p>where <span class="math notranslate nohighlight">\(\hatpsiaux = \hatpsiaux(\is')\)</span> is the estimate of the auxiliary flux [see <a class="reference internal" href="../../model/drive/synchronous_machine.html#equation-sm-mtpa-aux">(9)</a> in <a class="reference internal" href="../../model/drive/synchronous_machine.html#synchronous-machine"><span class="std std-ref">Synchronous Machine Model</span></a>] and <span class="math notranslate nohighlight">\(\sigma\)</span> is the attenuation, i.e., the resulting characteristic polynomial is <span class="math notranslate nohighlight">\(D(s) = s^2 + 2\sigma s + \omegamo^2\)</span>. By default, the attenuation in sensorless drives is scheduled as</p>
<div class="math notranslate nohighlight" id="equation-sigma-sensorless">
<span class="eqno">(23)<a class="headerlink" href="#equation-sigma-sensorless" title="Link to this equation">#</a></span>\[    \sigma = \frac{\beta}{2} + \zeta_\infty |\hatomegam |\]</div>
<p>where <span class="math notranslate nohighlight">\(\zeta_\infty\)</span> is the desired damping ratio at high speeds. At zero speed, one pole is placed at <span class="math notranslate nohighlight">\(s = 0\)</span> and another at <span class="math notranslate nohighlight">\(s = -\beta\)</span>. Unstable double pole at <span class="math notranslate nohighlight">\(s = 0\)</span> is avoided, enabling stable start of the machine.</p>
</section>
</section>
</section>
<section id="id20">
<h3>Speed Observer<a class="headerlink" href="#id20" title="Link to this heading">#</a></h3>
<p>The flux observer <a class="reference internal" href="#equation-sm-obs">(19)</a> is extended with the speed observer in the <a class="reference internal" href="../../autoapi/motulator/drive/control/sm/index.html#motulator.drive.control.sm.SpeedFluxObserver" title="motulator.drive.control.sm.SpeedFluxObserver"><code class="xref py py-class docutils literal notranslate"><span class="pre">motulator.drive.control.sm.SpeedFluxObserver</span></code></a> class. The angle-estimation error signal <span class="math notranslate nohighlight">\(\varepsilon\)</span> is extracted as</p>
<div class="math notranslate nohighlight" id="equation-sm-obs-eps">
<span class="eqno">(24)<a class="headerlink" href="#equation-sm-obs-eps" title="Link to this equation">#</a></span>\[    \varepsilon = -\IM\left\{ \frac{\eo}{\hatpsiaux} \right\}\]</div>
<p>Considering the rotor speed to be a quasi-constant disturbance, the speed can be estimated as <span id="id21">[<a class="reference internal" href="../../bibliography.html#id21" title="Hinkkanen, Saarakkala, Awan, MÃ¶lsÃ¤, and Tuovinen. Observers for sensorless synchronous motor drives: framework for design and analysis. IEEE Trans. Ind. Appl., 2018. doi:10.1109/TIA.2018.2858753.">Hinkkanen <em>et al.</em>, 2018</a>]</span></p>
<div class="math notranslate nohighlight" id="equation-sm-speed-obs-ro">
<span class="eqno">(25)<a class="headerlink" href="#equation-sm-speed-obs-ro" title="Link to this equation">#</a></span>\[    \frac{\D \hatomegam}{\D t} = \koomega \varepsilon\]</div>
<p>To avoid the lag in the speed estimate, the speed can be estimated based on the mechanical model and considering the load torque as a disturbance (see <a class="reference internal" href="../../model/drive/mechanics.html#equation-mech-stiff">(1)</a> in <a class="reference internal" href="../../model/drive/mechanics.html"><span class="doc">Mechanics</span></a>). This approach results in the speed observer</p>
<div class="math notranslate nohighlight" id="equation-sm-speed-obs">
<span class="eqno">(26)<a class="headerlink" href="#equation-sm-speed-obs" title="Link to this equation">#</a></span>\[\begin{split}    \frac{\D \hatomegam}{\D t} &amp;= \frac{\np}{\hat{J}}(\hattauM - \hattauL) + \koomega \varepsilon \\
    \frac{\D\hattauL}{\D t} &amp;= -\frac{\kotau}{\np} \varepsilon\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(\hattauL\)</span> is the load torque estimate and <span class="math notranslate nohighlight">\(\koomega\)</span> and <span class="math notranslate nohighlight">\(\kotau\)</span> are the observer gains. Note that setting <span class="math notranslate nohighlight">\(\hat{J} = \infty\)</span> and <span class="math notranslate nohighlight">\(\kotau = 0\)</span> yields the estimator <a class="reference internal" href="#equation-im-speed-obs-ro">(13)</a>; clearly, the inertia estimate <span class="math notranslate nohighlight">\(\hat{J}\)</span> can be safely overestimated. Originally <a class="reference internal" href="#equation-sm-speed-obs">(26)</a> was used in servo drives with incremental encoders <span id="id22">[<a class="reference internal" href="../../bibliography.html#id33" title="Lorenz and Van Patten. High-resolution velocity estimation for all-digital, ac servo drives. IEEE Trans. Ind. Appl., 1991. doi:10.1109/28.85485.">Lorenz and Van Patten, 1991</a>]</span> and signal-injection methods <span id="id23">[<a class="reference internal" href="../../bibliography.html#id28" title="Kim, Harke, and Lorenz. Sensorless control of interior permanent-magnet machine drives with zero-phase lag position estimation. IEEE Trans. Ind. Appl., 2003. doi:10.1109/TIA.2003.818966.">Kim <em>et al.</em>, 2003</a>]</span>.</p>
<section id="id24">
<h4>Gain Analysis and Selection<a class="headerlink" href="#id24" title="Link to this heading">#</a></h4>
<p>The flux observer design decouples the speed and position estimation from the flux estimation. Therefore, the speed estimation dynamics can be analyzed separately. The estimator <a class="reference internal" href="#equation-sm-speed-obs-ro">(25)</a> results in the second-order estimation dynamics</p>
<div class="math notranslate nohighlight" id="equation-sm-speed-obs-ro-lin">
<span class="eqno">(27)<a class="headerlink" href="#equation-sm-speed-obs-ro-lin" title="Link to this equation">#</a></span>\[    \frac{\Delta\hatomegam(s)}{\Delta\omegam(s)} = \frac{\alphao^2}{(s + \alphao)^2}\]</div>
<p>The critically damped design is obtained by setting <span class="math notranslate nohighlight">\(\kotheta = 2\alphao\)</span> and <span class="math notranslate nohighlight">\(\koomega = \alphao^2\)</span>, where <span class="math notranslate nohighlight">\(\alphao\)</span> is the desired pole location. The inertia estimate is avoided, but the lag limits achievable speed-control bandwidth <span id="id25">[<a class="reference internal" href="../../bibliography.html#id44" title="Tiitinen, Hinkkanen, and Harnefors. Design framework for sensorless control of synchronous machine drives. IEEE Trans. Ind. Electron., 2025. doi:10.1109/TIE.2024.3429650.">Tiitinen <em>et al.</em>, 2025</a>]</span>.</p>
<p>For the observer <a class="reference internal" href="#equation-sm-speed-obs">(26)</a>, the linearized estimation dynamics are</p>
<div class="math notranslate nohighlight" id="equation-sm-speed-obs-lin">
<span class="eqno">(28)<a class="headerlink" href="#equation-sm-speed-obs-lin" title="Link to this equation">#</a></span>\[    \frac{\Delta\hatomegam(s)}{\Delta\omegam(s)} =
    \frac{(J/\hat{J}) s^3 + (J/\hat{J}) \kotheta s^2 + \koomega s + \kotau/\hat{J}}{s^3 + \kotheta s^2 + \koomega s + \kotau/\hat{J}}\]</div>
<p>where the stiff mechanical model is assumed in the derivation. The critically damped design is obtained by setting <span class="math notranslate nohighlight">\(\kotheta = 3\alphao\)</span>, <span class="math notranslate nohighlight">\(\koomega = 3\alphao^2\)</span>, and <span class="math notranslate nohighlight">\(\kotau = \alphao^3 \hat{J}\)</span>.</p>
</section>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="flux_vector_ctrl.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Flux-Vector Control</p>
      </div>
    </a>
    <a class="right-next"
       href="reference_gen.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Reference Generation</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#for-induction-machines">For Induction Machines</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#machine-model">Machine Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flux-observer">Flux Observer</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#gain-analysis-and-selection">Gain Analysis and Selection</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sensored-drives">Sensored Drives</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sensorless-drives">Sensorless Drives</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#speed-observer">Speed Observer</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id10">Gain Analysis and Selection</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#for-synchronous-machines">For Synchronous Machines</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id13">Machine Model</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coordinate-transformation">Coordinate Transformation</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flux-and-position-observer">Flux and Position Observer</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id16">Gain Analysis and Selection</a><ul class="nav section-nav flex-column">
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#id17">Sensored Drives</a></li>
<li class="toc-h5 nav-item toc-entry"><a class="reference internal nav-link" href="#sm-obs-sensorless">Sensorless Drives</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id20">Speed Observer</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#id24">Gain Analysis and Selection</a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Aalto Electric Drives
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      Â© Copyright 2025, Aalto Electric Drives.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>