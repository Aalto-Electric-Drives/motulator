
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "auto_examples/vhz/plot_vhz_ctrl_6step_im_2kw.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        :ref:`Go to the end <sphx_glr_download_auto_examples_vhz_plot_vhz_ctrl_6step_im_2kw.py>`
        to download the full example code.

.. rst-class:: sphx-glr-example-title

.. _sphx_glr_auto_examples_vhz_plot_vhz_ctrl_6step_im_2kw.py:


2.2-kW induction motor, 6-step mode
===================================

This example simulates V/Hz control of a 2.2-kW induction motor drive. The 
six-step overmodulation is enabled, which increases the fundamental voltage as 
well as the harmonics. Since the PWM is not synchronized with the stator 
frequency, the harmonic content also depends on the ratio between the stator 
frequency and the sampling frequency.

.. GENERATED FROM PYTHON SOURCE LINES 13-22

.. code-block:: Python


    import numpy as np

    from motulator.drive import model
    import motulator.drive.control.im as control
    from motulator.drive.utils import (
        BaseValues, InductionMachinePars, InductionMachineInvGammaPars,
        NominalValues, plot, plot_extra, Sequence)








.. GENERATED FROM PYTHON SOURCE LINES 23-24

Compute base values based on the nominal values (just for figures).

.. GENERATED FROM PYTHON SOURCE LINES 24-28

.. code-block:: Python


    nom = NominalValues(U=400, I=5, f=50, P=2.2e3, tau=14.6)
    base = BaseValues.from_nominal(nom, n_p=2)








.. GENERATED FROM PYTHON SOURCE LINES 29-30

Create the system model.

.. GENERATED FROM PYTHON SOURCE LINES 30-43

.. code-block:: Python


    # Configure the induction machine using its inverse-Î“ parameters
    mdl_ig_par = InductionMachineInvGammaPars(
        n_p=2, R_s=3.7, R_R=2.1, L_sgm=.021, L_M=.224)
    mdl_par = InductionMachinePars.from_inv_gamma_model_pars(mdl_ig_par)
    machine = model.InductionMachine(mdl_par)
    # Mechanics with quadratic load torque coefficient
    k = .2*nom.tau/(base.w/base.n_p)**2
    mechanics = model.StiffMechanicalSystem(J=.015, B_L=lambda w_M: k*np.abs(w_M))
    converter = model.VoltageSourceConverter(u_dc=540)
    mdl = model.Drive(converter, machine, mechanics)
    mdl.pwm = model.CarrierComparison()  # Enable the PWM model








.. GENERATED FROM PYTHON SOURCE LINES 44-45

Control system (parametrized as open-loop V/Hz control).

.. GENERATED FROM PYTHON SOURCE LINES 45-51

.. code-block:: Python


    par = InductionMachineInvGammaPars(R_s=0*3.7, R_R=0*2.1, L_sgm=.021, L_M=.224)
    ctrl = control.VHzControl(
        control.VHzControlCfg(
            par, nom_psi_s=base.psi, k_u=0, k_w=0, overmodulation="six_step"))








.. GENERATED FROM PYTHON SOURCE LINES 52-53

Set the speed reference and the external load torque.

.. GENERATED FROM PYTHON SOURCE LINES 53-62

.. code-block:: Python


    # Speed reference
    times = np.array([0, .1, .3, 1])*2
    values = np.array([0, 0, 1, 1])*2*base.w
    ctrl.ref.w_m = Sequence(times, values)

    # External load torque could be set here, now zero
    mdl.mechanics.tau_L = lambda t: (t > 1.)*nom.tau*.1








.. GENERATED FROM PYTHON SOURCE LINES 63-64

Create the simulation object and simulate it.

.. GENERATED FROM PYTHON SOURCE LINES 64-68

.. code-block:: Python


    sim = model.Simulation(mdl, ctrl)
    sim.simulate(t_stop=2)








.. GENERATED FROM PYTHON SOURCE LINES 69-70

Plot results in per-unit values.

.. GENERATED FROM PYTHON SOURCE LINES 70-74

.. code-block:: Python


    # sphinx_gallery_thumbnail_number = 2
    plot(sim, base)
    plot_extra(sim, base, t_span=(0.58, 0.7))



.. rst-class:: sphx-glr-horizontal


    *

      .. image-sg:: /auto_examples/vhz/images/sphx_glr_plot_vhz_ctrl_6step_im_2kw_001.png
         :alt: plot vhz ctrl 6step im 2kw
         :srcset: /auto_examples/vhz/images/sphx_glr_plot_vhz_ctrl_6step_im_2kw_001.png
         :class: sphx-glr-multi-img

    *

      .. image-sg:: /auto_examples/vhz/images/sphx_glr_plot_vhz_ctrl_6step_im_2kw_002.png
         :alt: plot vhz ctrl 6step im 2kw
         :srcset: /auto_examples/vhz/images/sphx_glr_plot_vhz_ctrl_6step_im_2kw_002.png
         :class: sphx-glr-multi-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** (0 minutes 9.012 seconds)


.. _sphx_glr_download_auto_examples_vhz_plot_vhz_ctrl_6step_im_2kw.py:

.. only:: html

  .. container:: sphx-glr-footer sphx-glr-footer-example

    .. container:: sphx-glr-download sphx-glr-download-jupyter

      :download:`Download Jupyter notebook: plot_vhz_ctrl_6step_im_2kw.ipynb <plot_vhz_ctrl_6step_im_2kw.ipynb>`

    .. container:: sphx-glr-download sphx-glr-download-python

      :download:`Download Python source code: plot_vhz_ctrl_6step_im_2kw.py <plot_vhz_ctrl_6step_im_2kw.py>`

    .. container:: sphx-glr-download sphx-glr-download-zip

      :download:`Download zipped: plot_vhz_ctrl_6step_im_2kw.zip <plot_vhz_ctrl_6step_im_2kw.zip>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
